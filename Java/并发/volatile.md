### 概念

用来确保变量的通知操作更新到其他线程。读取volatile类型的变量时，总会返回最新写入的值。原因如下：

- 当把变量声明为volatile类型后，编译器和运行时都会注意到这个变量是共享的，因此不会将该变量上的操作与其他内存操作一起进行重排序
- volatile不会被缓存在寄存器或者处理器看不到的地方



### 非阻塞

访问volatile变量时，不会执行加锁操作，因此不会阻塞线程。



### 正确使用方式

volatile有它自身的局限性，它只能保证可见性，而加锁机制既可以保证可见性，又可以保证原子性。当且仅当满足以下所有条件时，才应该使用volatile变量：

- 对变量的写操作不依赖变量的当前值，或者你能确保只有单个线程能更新变量的值
- 该变量不会与其他状态变量一起纳入不变性条件中（如果该变量和其他状态变量一起决定了程序在多线程条件下，能正确执行，那该变量和状态变量应该直接加锁，也就不用使用volatile类型了）
- 在访问变量时不需要加锁



### 确保可见性

volatile可以确保域的可见性。如果你将1个域声明为volatile，那么只要对这个域进行了修改操作，那么所有的读操作都可以看到这个修改。即便使用了本地缓存，也是如此，因为volatile域会立即被写入主内存，而读操作就发生在主内存中。

如果多个线程同时访问某个域，那么这个域就应该是volatile的。否则这个域就只能使用同步来访问，同步也会导致向主内存中刷新。

