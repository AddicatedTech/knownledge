# ReentrantReadWriteLock

AQS维护了一个int值，表示同步状态；对于ReentrantLock，state会在0与1之间变化，1表示已被占有后续线程入队列等待，0表示free。对于CountDownLatch，会先将state赋予个大于0的值，在该值变为0后唤醒等待队列中的线程。那么如何用它来即表示读锁又表示写锁呢？读锁我们是允许多个线程同步运行的，我们还允许重入，那么拿什么来记录每个线程读锁的重入数？

针对上面两个问题，**对于同步状态status，高16位表示所有线程持有的读锁总数，低16位为一个线程的写锁总数，包括重入**。



## 源码



