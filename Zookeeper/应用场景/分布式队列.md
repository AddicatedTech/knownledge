# 分布式队列

业界有许多分布式队列的产品，大多数都是使用MQ消息中间件来实现。ZK也可以实现分布式队列。分布式队列有2种形式，1种是FIFO，1种是屏障。

ZK实现分布式队列的方法，类似于全写的共享锁。



## FIFO队列

- 每一个请求在同一个父节点下创建子节点
- 判断前面有没有序号比自己小的节点
- 如果有，则对序号比自己小的节点注册watcher，然后阻塞
- 如果没有，则可以执行业务逻辑





## 屏障

指的是多个请求都到达了，才可以执行某段代码

- 每个请求都在同一个父节点下面创建子节点
- 获取该父节点下所有节点，并且注册watcher监听
- 获取该父节点的所有子节点的个数
- 如果个数等于某个阈值，则可以执行业务逻辑
- 否则等待



