# 方案设计题



**1分钟内用户上线的数目是60万，如果用户在5分钟内重复上线，就给他发警告，问如何设计？**

（1）如果用户上线了，将用户的userId存储到redis，并且设置过期时间为5分钟

（2）如果用户5分钟内重复上线了，那么判断redis中还有这个key，那么就把这个userId包装成消息，放入到MQ中

（3）发送消息服务从MQ中拿到消息进行发送

（4）1分钟内用户上线数目是60万，那么极限情况下，每个用户都是不重复的用户，每个用户的userId都要存入到redis中，userId为Long类型，占8字节，则占用内存为  60 0000 * 5 * 8 = 600MB * 40 = 24000MB = 24G。

（5）24G占用内存比较大了，可以使用3台8G的机器来保存数据。

另外提一下，我们平常使用的数据是按字节来算的。比如说上面的24G，指的是24G个字节。